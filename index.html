<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…Ø¯ÛŒØ±ÛŒØª Ø§Ø¬Ø§Ø±Ù‡ ÙÙˆØªØ¨Ø§Ù„</title>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/css/persian-datepicker.min.css"/>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-date@1.1.0/dist/persian-date.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/persian-datepicker@1.2.0/dist/js/persian-datepicker.min.js"></script>

<style>
body{font-family:tahoma;background:#f4f6fa;margin:20px}
.card{background:white;padding:20px;border-radius:15px;box-shadow:0 5px 20px rgba(0,0,0,.08);margin-bottom:25px}
button{background:#2962ff;color:white;border:none;padding:8px 15px;border-radius:8px;cursor:pointer}
button:hover{background:#0039cb}
input,select{padding:8px;border-radius:8px;border:1px solid #ccc;width:100%;margin:5px 0}
.table{width:100%;border-collapse:collapse;margin-top:10px}
.table th,.table td{padding:10px;border-bottom:1px solid #eee;text-align:center}
.status-green{color:green;font-weight:bold}
.status-red{color:red;font-weight:bold}
.status-zero{color:#555;font-weight:bold}
#clock{font-size:18px;font-weight:bold;margin-bottom:15px}
.reserved-day{background:#ff5252 !important;color:white !important;border-radius:50%}
#calendar{margin-top:15px}
</style>
</head>
<body>

<div id="clock"></div>

<div class="card">
<h2>ØªØ§Ø±ÛŒØ®â€ŒÙ‡Ø§ÛŒ Ø±Ø²Ø±Ùˆ</h2>
<button id="openReserve">Ø§Ù†ØªØ®Ø§Ø¨ ØªØ§Ø±ÛŒØ® Ø±Ø²Ø±Ùˆ</button>
<p>ØªØ¹Ø¯Ø§Ø¯ Ø¬Ù„Ø³Ø§Øª: <span id="sessionCount">0</span></p>
<input type="hidden" id="reserveInput">
</div>

<div class="card">
<h2>ØªÙ‚ÙˆÛŒÙ… Ø³Ø§Ù†Ø³â€ŒÙ‡Ø§</h2>
<div id="calendar"></div>
</div>

<script>
let reservations=JSON.parse(localStorage.getItem("reservations"))||[]

function saveReservations(){
localStorage.setItem("reservations",JSON.stringify(reservations))
}

function updateClock(){
let now=new persianDate()
$("#clock").text("ğŸ“… "+now.format("YYYY/MM/DD")+" â° "+now.format("HH:mm:ss"))
}
setInterval(updateClock,1000)

// Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† ØªÙ‚ÙˆÛŒÙ… Ú†Ù†Ø¯ Ø§Ù†ØªØ®Ø§Ø¨ÛŒ
$("#reserveInput").persianDatepicker({
format:"YYYY/MM/DD",
multiple:true,
calendar:{persian:{locale:"fa"}},
onSelect:function(){
reservations=$("#reserveInput").val().split(",")
$("#sessionCount").text(reservations.length)
saveReservations()
renderCalendar()
}
})

$("#openReserve").click(function(){
$("#reserveInput").persianDatepicker("show")
})

// ØªÙ‚ÙˆÛŒÙ… Ø«Ø§Ø¨Øª Ù†Ù…Ø§ÛŒØ´ Ø³Ø§Ù†Ø³â€ŒÙ‡Ø§ (ÙÙ‚Ø· ÛŒÚ© ØªÙ‚ÙˆÛŒÙ…)
function renderCalendar(){
$("#calendar").persianDatepicker("destroy")
$("#calendar").persianDatepicker({
inline:true,
format:"YYYY/MM/DD",
calendar:{persian:{locale:"fa"}},
onRender:function(date){
let d=date.format("YYYY/MM/DD")
if(reservations.includes(d)){
return {className:"reserved-day"}
}
}
})
}

// Ù…Ù‚Ø¯Ø§Ø±Ø¯Ù‡ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
function init(){
if(reservations.length>0){
$("#reserveInput").val(reservations.join(","))
$("#sessionCount").text(reservations.length)
}
renderCalendar()
updateClock()
}
init()
</script>

</body>
</html>
